{% set name = "xarray" %}
{% set version = "2025.12.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.org/packages/source/{{ name[0] }}/{{ name }}/{{ name }}-{{ version }}.tar.gz
  sha256: 73f6a6fadccc69c4d45bdd70821a47c72de078a8a0313ff8b1e97cd54ac59fed

build:
  number: 0
  script: {{ PYTHON }} -m pip install . --no-deps --no-build-isolation -vv
  skip:  true  # [py<311]

requirements:
  host:
    - python
    - pip
    - wheel
    - setuptools >=77.0.3
    - setuptools_scm >=8
  run:
    - python
    - numpy >=1.26
    - packaging >=24.1
    - pandas >=2.2
  run_constrained:
    - scipy >=1.13
    # accel
    - numbagg >=0.8
    - numba >=0.62
    - flox >=0.9
    # io
    - netcdf4 >=1.6.0
    - zarr >=2.18
    - sparse >=0.15
    # viz
    - cartopy >=0.23
    - matplotlib-base >=3.8

# hdf5 not build with szip support
{% set deselect_tests = " --deselect=test_backends.py::TestNetCDF4Data::test_compression_encoding" %}
{% set deselect_tests = deselect_tests + " --deselect=test_backends_datatree.py::TestNetCDF4DataTree::test_compression_encoding" %}
test:
  source_files:
    - conftest.py
    - pyproject.toml
  imports:
    - xarray
    - xarray.backends
  commands:
    - pip check
    - python -c "from importlib.metadata import version; assert(version('{{ name }}')=='{{ version }}')"
    - pytest . --pyargs xarray.tests {{ deselect_tests }} -v -m "not (flaky or mypy or network or slow or slow_hypothesis)" -o addopts="[--strict-markers,--strict-config]"
  requires:
    - pip
    - pytest
    - pytest-xdist
    - pytest-timeout
    - pytest-asyncio
    - pooch
    - scipy
    - netcdf4

about:
  home: https://xarray.dev
  license: Apache-2.0
  license_file: LICENSE
  license_family: Apache
  summary: N-D labeled arrays and datasets in Python.
  description: |
    xarray (formerly xray) is an open source project and Python package
    that makes working with labelled multi-dimensional arrays simple,
    efficient, and fun!

    xarray introduces labels in the form of dimensions, coordinates and
    attributes on top of raw NumPy_-like arrays, which allows for a more
    intuitive, more concise, and less error-prone developer experience.
    The package includes a large and growing library of domain-agnostic functions for advanced analytics and visualization with these data structures.

    xarray was inspired by and borrows heavily from pandas_, the popular data analysis package focused on labelled tabular data.
    It is particularly tailored to working with netCDF_ files, which were the source of xarray's data model, and integrates tightly with dask_ for parallel computing.
  dev_url: https://github.com/pydata/xarray
  doc_url: https://docs.xarray.dev

extra:
  recipe-maintainers:
    - jhamman
    - ocefpaf
    - shoyer
